# Security configuration
# ======================

# Set the protocol version to 2 for security reasons. Disables legacy support.
Protocol 2

# Make sure sshd checks file modes and ownership before accepting logins. This prevents accidental misconfiguration.
StrictModes yes

LogLevel VERBOSE


# Authentication
# --------------

# The server disconnects after this time if the user has not successfully logged in
LoginGraceTime 30s

# maximum number of authentication attempts permitted per connection.
# Once the number of failures reaches half this value, additional failures are logged.
# Causes 'Too Many Authentication Failures' error when set to a low value and the user tries several keys.
MaxAuthTries 5

# Maximum number of open shell, login or subsystem (e.g. sftp) sessions permitted per network connection.
MaxSessions 10

# maximum number of concurrent unauthenticated connections to the SSH daemon, in the format X:Y:Z
# If the number of unauthenticated connections reaches X, then Y% of new connection attempts will be dropped
# This percentage scales linearly until the number of connections reaches Z, at which point all new connections will be dropped
MaxStartups 10:30:60

# Enable/disable root login
PermitRootLogin no

# Enable public key authentication
PubkeyAuthentication yes

# Never use host-based authentication. It can be exploited.
IgnoreRhosts yes
IgnoreUserKnownHosts yes
HostbasedAuthentication no

# Enable PAM to enforce system wide rules
UsePAM yes

# Enable/disable password-based authentication, which can make brute-force attacks easier
PasswordAuthentication no
PermitEmptyPasswords no
ChallengeResponseAuthentication no

# Only enable Kerberos authentication if it is configured.
KerberosAuthentication no
KerberosOrLocalPasswd no
KerberosTicketCleanup yes
#KerberosGetAFSToken no

# Only enable GSSAPI authentication if it is configured.
GSSAPIAuthentication no
GSSAPICleanupCredentials yes

AllowAgentForwarding yes

# Network
# -------

# Disable TCP keep alive since it is spoofable. Use ClientAlive messages instead, they use the encrypted channel
TCPKeepAlive no

# Send "client alive" messages to all clients every ClientAliveInterval seconds
# Disconnect any clients not responding to "client alive" messages after ClientAliveCountMax number of messages
ClientAliveInterval 300
ClientAliveCountMax 3

# Disable tunneling
PermitTunnel no

# Do not allow remote port forwardings to bind to non-loopback addresses.
GatewayPorts no

# Disable X11 forwarding, since local X11 display could be accessed through forwarded connection.
X11Forwarding no
X11UseLocalhost yes

# Only allow login for specified users
AllowUsers {{ default_username }} root


# Misc. configuration
# ===================

# The contents of the specified file are sent to the remote user before authentication is allowed.
# If the argument is none then no banner is displayed.
Banner none

# Enable compression
Compression yes
